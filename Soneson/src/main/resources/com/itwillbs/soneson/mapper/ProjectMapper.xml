<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itwillbs.soneson.mapper.ProjectMapper">
	

	
	<!-- 프로젝트 등록 start페이지 -->
	<select id="selectIdProj" resultType="Project">
		SELECT pro_code, user_id, pro_title
		FROM sample_pro 
		WHERE user_id = #{sId}
		ORDER BY pro_code asc
		Limit 1
	</select>
	
	<!-- 이어쓰기 -->
	<select id="selectProject" resultType="Project">
		SELECT *
		FROM sample_pro
		WHERE user_id = #{user_id} AND pro_code = #{pro_code}
	</select>
	
	<select id="selectNewProject" resultType="Project">
		SELECT *
		FROM sample_pro
		WHERE user_id = #{user_id}
		ORDER BY pro_insertDt DESC
		LIMIT 1
	</select>
	
	
	
	<!-- 약관동의 후 insert -->
	<insert id="insertStartProj">
		INSERT INTO sample_pro(
			pro_code
			, user_id
			, pro_categorie
			, pro_title
			, pro_agree
			, pro_insertDt
		)
		VALUES (
			null
			,#{user_id}
			, #{pro_categorie}
			, #{pro_title}
			, 'Y'
			, now()
		)
	</insert>
	
	
	<!-- 저장 전 파일명 가져오기 -->
	<select id="selectFileName" resultType="Project">
		SELECT pro_thumbsnail
				,pro_content
				,pro_budget
				,pro_sch
				,pro_team
				,pro_reward
				,pro_profile
		FROM sample_pro
		WHERE pro_code = #{pro_code}
	</select>
	
	
	<!-- 저장하기 -->
	<update id="updateProject">
		UPDATE sample_pro
		SET
			pro_title = #{pro_title}
			, pro_categorie = #{pro_categorie}
			, pro_summary = #{pro_summary}
			<if test="pro_thumbsnail != null and !pro_thumbsnail.equals('')">
				, pro_thumbsnail = #{pro_thumbsnail}
			</if>
			, pro_goal = #{pro_goal}
			<if test="pro_startDt != null and !pro_startDt.equals('')">
				, pro_startDt = #{pro_startDt}
			</if>
			<if test="pro_endDt != null and !pro_endDt.equals('')">
				, pro_endDt = #{pro_endDt}
			</if>
			<if test="pro_content != null and !pro_content.equals('')">
				, pro_content = #{pro_content}
			</if>
			<if test="pro_budget != null and !pro_budget.equals('')">
				, pro_budget = #{pro_budget}
			</if>
			<if test="pro_sch != null and !pro_sch.equals('')">
				, pro_sch = #{pro_sch}
			</if>
			<if test="pro_team != null and !pro_team.equals('')">
				, pro_team = #{pro_team}
			</if>
			<if test="pro_reward != null and !pro_reward.equals('')">
				, pro_reward = #{pro_reward}
			</if>
			, pro_notice = #{pro_notice}
			, pro_creator = #{pro_creator}
			<if test="pro_profile != null and !pro_profile.equals('')">
				, pro_profile = #{pro_profile}
			</if>
			, pro_createrInfo = #{pro_createrInfo}
			, pro_userAuth = #{pro_userAuth}
		WHERE pro_code = #{pro_code}
			
	</update>
	
	
	
	
	<!-- 아래는 프로젝트 리스트 -->
	
	<select id="selectProjectList" resultType="Project">
		SELECT *
		FROM project
	</select>
	
	<select id="getProjectList" resultType="map">
		SELECT *
		FROM project
	</select>
	
	
	
	
</mapper>

